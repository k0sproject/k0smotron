---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.18.0
  labels:
    cluster.x-k8s.io/provider: bootstrap-k0smotron
    cluster.x-k8s.io/v1beta1: v1beta1
    cluster.x-k8s.io/v1beta2: v1beta2
  name: k0scontrollerconfigs.bootstrap.cluster.x-k8s.io
spec:
  group: bootstrap.cluster.x-k8s.io
  names:
    kind: K0sControllerConfig
    listKind: K0sControllerConfigList
    plural: k0scontrollerconfigs
    singular: k0scontrollerconfig
  scope: Namespaced
  versions:
  - deprecated: true
    name: v1beta1
    schema:
      openAPIV3Schema:
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            properties:
              args:
                description: |-
                  Args specifies extra arguments to be passed to k0s controller.
                  See: https://docs.k0sproject.io/stable/cli/k0s_controller/
                items:
                  type: string
                type: array
              customUserDataRef:
                description: |-
                  CustomUserDataRef is a reference to a secret or a configmap that contains the custom user data.
                  Provided user-data will be merged with the one generated by k0smotron. Note that you may want to specify the merge type.
                  See: https://cloudinit.readthedocs.io/en/latest/reference/merging.html
                properties:
                  configMapRef:
                    description: ConfigMapRef is a reference to a configmap that contains
                      the content.
                    properties:
                      key:
                        description: Key is the key in the source that contains the
                          content
                        type: string
                      name:
                        description: Name is the name of the source
                        type: string
                    required:
                    - key
                    - name
                    type: object
                  secretRef:
                    description: SecretRef is a reference to a secret that contains
                      the content.
                    properties:
                      key:
                        description: Key is the key in the source that contains the
                          content
                        type: string
                      name:
                        description: Name is the name of the source
                        type: string
                    required:
                    - key
                    - name
                    type: object
                type: object
              downloadURL:
                description: |-
                  DownloadURL specifies the URL from which to download the k0s binary.
                  If the version field is specified, it is ignored, and whatever version is downloaded from the URL is used.
                  Supported protocols are: http, https, oci. Using 'oci' scheme requires 'oras' to be installed on the target system.

                  If 'oci' schema is used and the OCI registry requires authentication, make sure to set up the authentication beforehand
                  by adding a file to the Files section that contains the necessary config for ORAS. See: https://oras.land/docs/how_to_guides/authentication/
                  The file must be placed at `/root` directory (HOME for cloud-init execution time) and named `config.json`.
                  NOTE: use `.preStartCommands` to set DOCKER_CONFIG environment variable in order to let ORAS pick up your custom config file.
                type: string
              files:
                description: Files specifies extra files to be passed to user_data
                  upon creation.
                items:
                  description: File defines a file to be passed to user_data upon
                    creation.
                  properties:
                    content:
                      type: string
                    contentFrom:
                      description: ContentFrom specifies the source of the content.
                      properties:
                        configMapRef:
                          description: ConfigMapRef is a reference to a configmap
                            that contains the content.
                          properties:
                            key:
                              description: Key is the key in the source that contains
                                the content
                              type: string
                            name:
                              description: Name is the name of the source
                              type: string
                          required:
                          - key
                          - name
                          type: object
                        secretRef:
                          description: SecretRef is a reference to a secret that contains
                            the content.
                          properties:
                            key:
                              description: Key is the key in the source that contains
                                the content
                              type: string
                            name:
                              description: Name is the name of the source
                              type: string
                          required:
                          - key
                          - name
                          type: object
                      type: object
                    path:
                      type: string
                    permissions:
                      type: string
                  type: object
                type: array
              ignition:
                description: Ignition defines the ignition configuration. If empty,
                  k0smotron will use cloud-init.
                properties:
                  additionalConfig:
                    description: |-
                      AdditionalConfig is an unstructured object that contains additional config to be merged
                      with the generated one. The format follows Butane spec: https://coreos.github.io/butane/
                    type: string
                  variant:
                    description: |-
                      Variant declares which distribution variant the generated config is for.
                      Check the supported variants and versions here:
                      https://coreos.github.io/butane/specs/#butane-specifications-and-ignition-specifications
                    enum:
                    - fcos
                    - flatcar
                    - openshift
                    - r4e
                    - fiot
                    type: string
                  version:
                    description: |-
                      Version is the schema version of the Butane config to use
                      Check the supported variants and versions here:
                      https://coreos.github.io/butane/specs/#butane-specifications-and-ignition-specifications
                    type: string
                required:
                - variant
                - version
                type: object
              k0s:
                description: |-
                  K0s defines the k0s configuration. Note, that some fields will be overwritten by k0smotron.
                  If empty, will be used default configuration. @see https://docs.k0sproject.io/stable/configuration/
                type: object
                x-kubernetes-preserve-unknown-fields: true
              k0sInstallDir:
                default: /usr/local/bin
                description: |-
                  K0sInstallDir specifies the directory where k0s binary will be installed.
                  If empty, k0smotron will use /usr/local/bin, which is the default install path used by k0s get script.
                type: string
              postStartCommands:
                description: PostStartCommands specifies commands to be run after
                  starting k0s worker.
                items:
                  type: string
                type: array
              preInstalledK0s:
                description: PreInstallK0s specifies whether k0s binary is pre-installed
                  on the node.
                type: boolean
              preStartCommands:
                description: PreStartCommands specifies commands to be run before
                  starting k0s worker.
                items:
                  type: string
                type: array
              tunneling:
                description: Tunneling defines the tunneling configuration for the
                  cluster.
                properties:
                  enabled:
                    default: false
                    description: Enabled specifies whether tunneling is enabled.
                    type: boolean
                  mode:
                    default: tunnel
                    description: |-
                      Mode describes tunneling mode.
                      If empty, k0smotron will use the default one.
                    enum:
                    - tunnel
                    - proxy
                    type: string
                  serverAddress:
                    description: |-
                      Server address of the tunneling server.
                      If empty, k0smotron will try to detect worker node address for.
                    type: string
                  serverNodePort:
                    default: 31700
                    description: |-
                      NodePort to publish for server port of the tunneling server.
                      If empty, k0smotron will use the default one.
                    format: int32
                    type: integer
                  tunnelingNodePort:
                    default: 31443
                    description: |-
                      NodePort to publish for tunneling port.
                      If empty, k0smotron will use the default one.
                    format: int32
                    type: integer
                type: object
              useSystemHostname:
                default: false
                description: |-
                  UseSystemHostname specifies whether to use the system hostname for the kubernetes node name.
                  By default, k0smotron will use Machine name as a node name. If true, it will pick it from `hostname` command output.
                type: boolean
              version:
                description: |-
                  Version is the version of k0s to use. In case this is not set, k0smotron will use
                  a version field of the Machine object. If it's empty, the latest version is used.
                  Make sure the version is compatible with the k0s version running on the control plane.
                  For reference see the Kubernetes version skew policy: https://kubernetes.io/docs/setup/release/version-skew-policy/
                type: string
              workingDir:
                description: WorkingDir specifies the working directory where k0smotron
                  will place its files.
                type: string
            type: object
          status:
            properties:
              conditions:
                description: Conditions defines current service state of the K0sControllerConfig.
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
              dataSecretName:
                description: DataSecretName is the name of the secret that stores
                  the bootstrap data script.
                type: string
              ready:
                description: Ready indicates the Bootstrapdata field is ready to be
                  consumed
                type: boolean
            type: object
        type: object
    served: true
    storage: false
    subresources:
      status: {}
  - name: v1beta2
    schema:
      openAPIV3Schema:
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            properties:
              args:
                description: |-
                  Args specifies extra arguments to be passed to k0s controller.
                  See: https://docs.k0sproject.io/stable/cli/k0s_controller/
                items:
                  type: string
                type: array
              downloadURL:
                description: |-
                  DownloadURL specifies the URL from which to download the k0s binary.
                  If the version field is specified, it is ignored, and whatever version is downloaded from the URL is used.
                  Supported protocols are: http, https, oci. Using 'oci' scheme requires 'oras' to be installed on the target system.

                  If 'oci' schema is used and the OCI registry requires authentication, make sure to set up the authentication beforehand
                  by adding a file to the Files section that contains the necessary config for ORAS. See: https://oras.land/docs/how_to_guides/authentication/
                  The file must be placed at `/root` directory (HOME for cloud-init execution time) and named `config.json`.
                  NOTE: use `.preStartCommands` to set DOCKER_CONFIG environment variable in order to let ORAS pick up your custom config file.
                type: string
              files:
                description: Files specifies extra files to be passed to user_data
                  upon creation.
                items:
                  description: File defines a file to be passed to user_data upon
                    creation.
                  properties:
                    content:
                      type: string
                    contentFrom:
                      description: ContentFrom specifies the source of the content.
                      properties:
                        configMapRef:
                          description: ConfigMapRef is a reference to a configmap
                            that contains the content.
                          properties:
                            key:
                              description: Key is the key in the source that contains
                                the content
                              type: string
                            name:
                              description: Name is the name of the source
                              type: string
                          required:
                          - key
                          - name
                          type: object
                        secretRef:
                          description: SecretRef is a reference to a secret that contains
                            the content.
                          properties:
                            key:
                              description: Key is the key in the source that contains
                                the content
                              type: string
                            name:
                              description: Name is the name of the source
                              type: string
                          required:
                          - key
                          - name
                          type: object
                      type: object
                    path:
                      type: string
                    permissions:
                      type: string
                  type: object
                type: array
              k0s:
                description: |-
                  K0s defines the k0s configuration. Note, that some fields will be overwritten by k0smotron.
                  If empty, will be used default configuration. @see https://docs.k0sproject.io/stable/configuration/
                type: object
                x-kubernetes-preserve-unknown-fields: true
              k0sInstallDir:
                default: /usr/local/bin
                description: |-
                  K0sInstallDir specifies the directory where k0s binary will be installed.
                  If empty, k0smotron will use /usr/local/bin, which is the default install path used by k0s get script.
                type: string
              postK0sCommands:
                description: PostK0sCommands specifies commands to be run after starting
                  k0s worker.
                items:
                  type: string
                type: array
              preInstalledK0s:
                description: PreInstallK0s specifies whether k0s binary is pre-installed
                  on the node.
                type: boolean
              preK0sCommands:
                description: PreK0sCommands specifies commands to be run before starting
                  k0s worker.
                items:
                  type: string
                type: array
              provisioner:
                description: Provisioner defines the provisioner configuration. Defaults
                  to cloud-init.
                properties:
                  customUserDataRef:
                    description: |-
                      CustomUserDataRef is a reference to a secret or a configmap that contains the custom user data.
                      Provided user-data will be merged with the one generated by k0smotron. Note that you may want to specify the merge type.
                      See: https://cloudinit.readthedocs.io/en/latest/reference/merging.html
                    properties:
                      configMapRef:
                        description: ConfigMapRef is a reference to a configmap that
                          contains the content.
                        properties:
                          key:
                            description: Key is the key in the source that contains
                              the content
                            type: string
                          name:
                            description: Name is the name of the source
                            type: string
                        required:
                        - key
                        - name
                        type: object
                      secretRef:
                        description: SecretRef is a reference to a secret that contains
                          the content.
                        properties:
                          key:
                            description: Key is the key in the source that contains
                              the content
                            type: string
                          name:
                            description: Name is the name of the source
                            type: string
                        required:
                        - key
                        - name
                        type: object
                    type: object
                  ignition:
                    description: Ignition defines the ignition configuration. If empty,
                      k0smotron will use cloud-init.
                    properties:
                      additionalConfig:
                        description: |-
                          AdditionalConfig is an unstructured object that contains additional config to be merged
                          with the generated one. The format follows Butane spec: https://coreos.github.io/butane/
                        type: string
                      variant:
                        description: |-
                          Variant declares which distribution variant the generated config is for.
                          Check the supported variants and versions here:
                          https://coreos.github.io/butane/specs/#butane-specifications-and-ignition-specifications
                        enum:
                        - fcos
                        - flatcar
                        - openshift
                        - r4e
                        - fiot
                        type: string
                      version:
                        description: |-
                          Version is the schema version of the Butane config to use
                          Check the supported variants and versions here:
                          https://coreos.github.io/butane/specs/#butane-specifications-and-ignition-specifications
                        type: string
                    required:
                    - variant
                    - version
                    type: object
                  type:
                    default: cloud-config
                    description: Type is the provisioner format type.
                    enum:
                    - cloud-config
                    - ignition
                    - powershell
                    - powershell-xml
                    type: string
                type: object
              secretMetadata:
                description: SecretMetadata specifies metadata (labels and annotations)
                  to be propagated to the bootstrap Secret.
                properties:
                  annotations:
                    additionalProperties:
                      type: string
                    description: Annotations to be added to the bootstrap Secret
                    type: object
                  labels:
                    additionalProperties:
                      type: string
                    description: Labels to be added to the bootstrap Secret
                    type: object
                type: object
              tunneling:
                description: Tunneling defines the tunneling configuration for the
                  cluster.
                properties:
                  enabled:
                    default: false
                    description: Enabled specifies whether tunneling is enabled.
                    type: boolean
                  mode:
                    default: tunnel
                    description: |-
                      Mode describes tunneling mode.
                      If empty, k0smotron will use the default one.
                    enum:
                    - tunnel
                    - proxy
                    type: string
                  serverAddress:
                    description: |-
                      Server address of the tunneling server.
                      If empty, k0smotron will try to detect worker node address for.
                    type: string
                  serverNodePort:
                    default: 31700
                    description: |-
                      NodePort to publish for server port of the tunneling server.
                      If empty, k0smotron will use the default one.
                    format: int32
                    type: integer
                  tunnelingNodePort:
                    default: 31443
                    description: |-
                      NodePort to publish for tunneling port.
                      If empty, k0smotron will use the default one.
                    format: int32
                    type: integer
                type: object
              useSystemHostname:
                default: false
                description: |-
                  UseSystemHostname specifies whether to use the system hostname for the kubernetes node name.
                  By default, k0smotron will use Machine name as a node name. If true, it will pick it from `hostname` command output.
                type: boolean
              version:
                description: |-
                  Version is the version of k0s to use. In case this is not set, k0smotron will use
                  a version field of the Machine object. If it's empty, the latest version is used.
                  Make sure the version is compatible with the k0s version running on the control plane.
                  For reference see the Kubernetes version skew policy: https://kubernetes.io/docs/setup/release/version-skew-policy/
                type: string
              workingDir:
                description: WorkingDir specifies the working directory where k0smotron
                  will place its files.
                type: string
            type: object
          status:
            properties:
              conditions:
                description: Conditions defines current service state of the K0sControllerConfig.
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
              dataSecretName:
                description: DataSecretName is the name of the secret that stores
                  the bootstrap data script.
                type: string
              initialization:
                description: Initialization represents the initialization status of
                  the worker node
                properties:
                  dataSecretCreated:
                    type: boolean
                type: object
              ready:
                description: Ready indicates the Bootstrapdata field is ready to be
                  consumed
                type: boolean
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
