apiVersion: controlplane.cluster.x-k8s.io/v1beta1
kind: K0sControlPlane
metadata:
  name: ${CLUSTER_NAME}-aws-test
  namespace: ${NAMESPACE}
spec:
  k0sConfigSpec:
    k0sInstallDir: /opt/bin # Flatcar, as inmutable OS, needs k0s in /opt/bin. It cannot write k0s binary in the default /usr/local/bin.
    ignition:
      variant: flatcar
      version: 1.1.0
      additionalConfig: |
        variant: flatcar
        version: 1.1.0
        passwd:
          users:
            - name: core
              ssh_authorized_keys:
                - ssh-rsa ${SSH_PUBLIC_KEY}